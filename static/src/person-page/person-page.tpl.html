<div ng-show="profileStatus=='no_email'" class="page person-incomplete set-email">
    <h2>Set email</h2>
    <p class="instructions">
        Almost ready! We just need your email so we can send you updates when
        we find new online attention for your research (we won't use this email for
        spam or product offers).
    </p>
    <div class="setting-email" ng-show="settingEmail"></div>
    <form ng-show="!settingEmail" class="user-input" ng-submit="submitEmail()">
        <div class="form-group">
            <label for="user-email">Email address</label>
            <input ng-model="userForm.email"
                   type="email"
                   class="form-control input-lg"
                   id="user-email"
                   required
                   placeholder="Email">
        </div>
        <button type="submit" class="btn btn-primary btn-lg">Make my profile!</button>
    </form>

</div>

<div ng-show="profileStatus=='no_products'" class="page person-incomplete add-products">
    <h2>Add products</h2>

</div>

<div ng-show="profileStatus=='all_good'" class="page person">

    <div class="person-header row">
        <div class="col-md-9 person-about">
            <div class="content">
                <div class="avatar">
                    <img ng-src="{{ person.picture }}" alt=""/>
                </div>

                <div class="bio">
                    <h2 class="name">
                       {{ person.given_names }} {{ person.family_name }}
                    </h2>
                    <div class="aff">
                        <span class="institution">{{ person.affiliation_name }}</span>
                        <span class="role">
                            {{ person.affiliation_role_title }}
                        </span>
                    </div>
                    <div class="accounts">
                        <a href="http://orcid.org/{{ person.orcid_id }}">
                            <img src="static/img/favicons/orcid.ico" alt="">
                        </a>



                        <a href="http://depsy.org/{{ person.depsy_id }}"
                                ng-show="person.depsy_id">
                            <img src="static/img/favicons/depsy.png" alt="">
                        </a>
                        <a href="http://twitter.com/{{ person.twitter }}"
                           ng-show="person.twitter"
                           class="twitter">
                            <img src="static/img/favicons/twitter.ico" alt="">
                        </a>
                    </div>

                </div>
            </div>

        </div>
        <div class="col-md-3 person-actions"></div>
    </div>


    <div class="person-main row">

        <div class="scores-col col-md-4">
            <div class="metrics-section">

                <div class="main-score {{ person.belt }}belt">
                    <span class="score-value">
                        {{ numFormat.short(person.altmetric_score) }}
                    </span>
                    <span class="score-label" ng-click="personScoreModal()">
                        online impact score
                    </span>
                </div>

                <div class="score-belt {{ beltInfo.name }}belt" ng-click="beltModal()">
                    <span class="name">{{ beltInfo.name }} belt</span>
                    <span class="descr">: {{ beltInfo.descr }}</span>
                </div>

                <div class="sources-list">
                    <div class="pseudo-source source achievements" ng-click="setWorkspace('achievements')">
                        <span class="favicon">
                            <i class="fa fa-trophy"></i>
                        </span>
                        <span class="name">Achievements</span>
                        <span class="last-week"></span>
                        <span class="value">
                            {{person.badges.length}}
                        </span>
                    </div>
                    <div class="pseudo-source source products" ng-click="setWorkspace('products')">
                        <span class="favicon">
                            <i class="fa fa-file-text-o"></i>
                        </span>
                        <span class="name">Products</span>
                        <span class="last-week"></span>
                        <span class="value">
                            {{person.products.length}}
                        </span>
                    </div>

                    <div class="source last-real-source-{{$last}}"
                         ng-repeat="source in person.sources | orderBy: '-posts_count'">
                        <span class="favicon">
                            <img ng-src="/static/img/favicons/{{ source.source_name }}.ico">
                        </span>
                        <span class="name">{{ source.display_name }}</span>
                        <span class="last-week">
                            <span class="show"
                                  tooltip="{{ source.events_last_week_count }} new this week"
                                  ng-show="source.events_last_week_count">
                                <i class="fa fa-arrow-up"></i>
                            </span>
                        </span>
                        <span class="value">
                            {{ numFormat.short(source.posts_count) }}
                        </span>
                    </div>
                </div>
                <a class="learn-more" href="about/metrics">
                    <i class="fa fa-info-circle"></i>
                    <span class="text">Learn more about metrics</span>
                </a>
            </div>
        </div>


        <div class="workspace-col col-md-8">
            <div class="workspace-view row achievements" ng-if="workspace=='achievements'">
                <span class="extra">
                    {{person.given_names}} has
                </span>
                <h3>
                    <span class="count">{{ person.badges.length }}</span>
                    <span class="name">Achievements</span>
                </h3>

                <div class="achievements-list">
                    <div class="achievements workspace-item" ng-repeat="badge in badges | orderBy: 'sortLevel' ">
                        <div class="title">
                            <a href="/u/{{ person.orcid_id }}/badge/{{ badge.name }}">{{badge.display_name}}</a>
                            <span class="extra badge-level-{{ badge.level }}">{{badge.level}}</span>
                        </div>
                        <div class="under">
                            {{ badge.description }}
                        </div>
                    </div>
                </div>
            </div>



            <div class="workspace-view row products" ng-if="workspace=='products'">
                <span class="extra">
                    We found online impacts for
                </span>
                <h3>
                    <span class="count">{{ person.products.length }}</span>
                    <span class="name">research products</span>
                </h3>

                <table class="products">
                    <thead>
                        <th class="biblio"></th>
                        <th class="sources"></th>
                        <tn class="score"></tn>
                        <tn class="has-new"></tn>
                    </thead>
                    <tbody>
                        <tr ng-repeat="product in person.products | orderBy : '-altmetric_score'" class="workspace-item">
                            <td class="biblio">
                                <div class="title">
                                    <a href="u/{{person.orcid_id}}/product/doi/{{ product.doi }}">{{ product.title }}</a>
                                </div>
                                <div class="under">
                                    <span class="year">{{ product.year }}</span>
                                    <span class="journal">{{ product.journal }}</span>
                                </div>
                            </td>
                            <td class="sources has-oodles-{{ product.sources.length > 6 }}">
                                <span class="source-icon"
                                      ng-repeat="source in product.sources | orderBy: 'display_name'">
                                    <md-tooltip md-direction="top">
                                      {{ source.posts_count }} {{source.display_name }}
                                    </md-tooltip>
                                    <img ng-src="/static/img/favicons/{{ source.source_name }}.ico" class="{{source.source_name}}">
                                </span>
                            </td>
                            <td class="score">
                                <span class="score-container">
                                    <md-tooltip md-direction="top">
                                      Altmetric.com score
                                    </md-tooltip>
                                    {{ numFormat.short(product.altmetric_score) }}

                                </span>
                            </td>
                            <td class="has-new">
                                <i class="fa fa-arrow-up" ng-show="product.events_last_week_count > 0"></i>
                            </td>

                        </tr>
                    </tbody>
                </table>

            </div>

            <!--<div class="row person-footer">-->
                <!--<div class="text col-md-8">-->
                    <!--This page uses open data (yay!) from-->
                    <!--<a href="http://orcid.org/{{ person.orcid_id }}">{{ person.given_names }} {{ person.family_name }}'s ORCID profile</a>,-->
                    <!--and metrics from-->
                    <!--<a href="http://altmetric.com">Altmetric.com.</a>-->
                    <!--<span class="text">-->
                        <!--All the data you see here is open for re-use.-->
                    <!--</span>-->
                <!--</div>-->
                <!--<div class="buttons col-md-4">-->
                    <!--<a class="btn btn-xs btn-default"-->
                       <!--target="_self"-->
                       <!--href="/api/person/{{ person.orcid_id }}">-->
                        <!--<i class="fa fa-cogs"></i>-->
                        <!--view as JSON-->
                    <!--</a>-->
                <!--</div>-->
            <!--</div>-->



        </div>
    </div>
    <div class="row person-footer">
        <div class="text col-md-8">
            This page uses open data (yay!) from
            <a href="http://orcid.org/{{ person.orcid_id }}">{{ person.given_names }} {{ person.family_name }}'s ORCID profile</a>,
            and metrics from
            <a href="http://altmetric.com">Altmetric.com.</a>
            <span class="text">
                All the data you see here is open for re-use.
            </span>
        </div>
        <div class="buttons col-md-4">
            <a class="btn btn-xs btn-default"
               target="_self"
               href="/api/person/{{ person.orcid_id }}">
                <i class="fa fa-cogs"></i>
                view as JSON
            </a>
        </div>

    </div>

</div>

